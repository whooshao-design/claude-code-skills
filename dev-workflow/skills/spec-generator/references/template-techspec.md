# {功能名称} - 技术方案

> 本文档由方案设计系统自动生成，评审通过后方可进入开发阶段。

## 文档信息

| 项目 | 内容 |
|------|------|
| **版本** | v1.0 |
| **作者** | {作者} |
| **日期** | {YYYY-MM-DD} |
| **需求来源** | [req-spec.md](../需求文档/req-spec.md) |
| **复杂度** | Simple / Medium / Complex |

---

## 1. 概述

### 1.1 功能摘要
[一句话描述这个功能做什么，以及为什么需要它]

### 1.2 需求参考
[关键需求的简要总结，建议引用 req-spec.md 中的具体章节]

- 需求点 1：[引用]
- 需求点 2：[引用]

---

## 2. 技术上下文

### 2.1 技术栈
| 类别 | 技术 | 版本/备注 |
|------|------|-----------|
| 开发语言 | Java | 8+ |
| 核心框架 | Spring | 5.x |
| RPC 框架 | Alibaba Dubbo | 2.7.x |
| 数据库 | MySQL | 5.7+ |
| 缓存 | Redis | 6.x |
| 消息队列 | Kafka | 2.x |
| 配置中心 | Hippo | - |

### 2.2 相关代码区域
[列出将受影响或被引用的目录/模块]

- `src/main/java/com/example/module/` - [描述]
- `src/main/java/com/example/service/` - [描述]
- `src/test/java/com/example/` - [描述]

### 2.3 现有模式识别
[记录在代码库中发现的、应遵循的模式]

**模式 1：[模式名称]**
- 位置：`path/to/example`
- 描述：[该模式如何工作]
- 适用性：[我们将如何使用这个模式]

**模式 2：[模式名称]**
- ...

---

## 3. 方案设计

### 3.1 方案对比（如存在多个选项）

| 维度 | 方案 A：[名称] | 方案 B：[名称] |
|------|----------------|----------------|
| 描述 | [简要描述] | [简要描述] |
| 优点 | | |
| 缺点 | | |
| 复杂度 | 低/中/高 | 低/中/高 |
| 风险 | 低/中/高 | 低/中/高 |

**选定方案**：[方案 X]
**选择理由**：[为什么选择这个方案]

### 3.2 架构概览
[解决方案架构的高层描述]

```
[ASCII 图或组件关系描述]

┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   Client    │────▶│  Dispatcher │────▶│  Executor   │
└─────────────┘     └─────────────┘     └─────────────┘
```

### 3.3 API 设计

#### 接口 1：[HTTP 方法] /api/path

- **用途**：[这个接口做什么]
- **接口方**：Dubbo / HTTP
- **版本**：v1

**请求参数**：
```json
{
  "field": "类型 - 必填/可选 - 描述"
}
```

**响应参数**：
```json
{
  "code": "String - 必填 - 结果码",
  "message": "String - 必填 - 结果描述",
  "data": "Object - 可选 - 业务数据"
}
```

**错误码**：
| 错误码 | 说明 | 处理建议 |
|--------|------|----------|
| E001 | xxx | xxx |

#### 接口 2：[...]
[重复上述格式]

### 3.4 数据模型

#### 实体：[EntityName]

| 字段 | 类型 | 约束 | 描述 |
|------|------|------|------|
| id | Long | PK, Auto | 主键 |
| xxx | xxx | xxx | xxx |

#### 数据库变更

**新建表**：[table_name]
```sql
CREATE TABLE `table_name` (
  `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键',
  `xxx` VARCHAR(32) DEFAULT NULL COMMENT 'xxx',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='xxx';
```

**修改表**：[table_name]
- 新增字段：`xxx`
- 字段变更：xxx
- 索引变更：xxx

---

## 4. 实现要点

### 4.1 需新建的类/组件

| 类/组件 | 职责 | 位置 |
|---------|------|------|
| [ClassName] | [做什么] | `src/path/` |
| [ClassName] | [做什么] | `src/path/` |

### 4.2 需修改的类/组件

| 类/组件 | 修改内容 | 原因 |
|---------|----------|------|
| [ClassName] | [改什么] | [为什么] |
| [ClassName] | [改什么] | [为什么] |

### 4.3 核心流程设计

#### 流程 1：[流程名称]

```
步骤 1: xxx
步骤 2: xxx
步骤 3: xxx
```

**关键逻辑点**：
- [ ] [逻辑点1]
- [ ] [逻辑点2]

#### 流程 2：[...]
[重复上述格式]

### 4.4 依赖项

[列出需要的新依赖]

```xml
<dependency>
    <groupId>xxx</groupId>
    <artifactId>xxx</artifactId>
    <version>xxx</version>
</dependency>
```

---

## 5. 异常处理

### 5.1 异常场景

| 场景 | 处理方式 | 优先级 |
|------|----------|--------|
| xxx | xxx | P0 |

### 5.2 降级策略

[异常情况下的降级方案]

### 5.3 幂等设计

[如何保证接口/操作幂等]

---

## 6. 可观测性

### 6.1 监控指标

| 指标名称 | 指标类型 | 报警阈值 |
|----------|----------|----------|
| xxx | counter | > 10/min |

### 6.2 埋点需求

| 埋点位置 | 埋点字段 | 说明 |
|----------|----------|------|
| 入口 | xxx | xxx |
| 决策点 | xxx | xxx |

### 6.3 告警规则

- **告警规则 1**：[描述]
- **告警规则 2**：[描述]

---

## 7. 风险评估

### 7.1 技术风险

| 风险 | 可能性 | 影响 | 缓解措施 |
|------|--------|------|----------|
| xxx | 低/中/高 | 低/中/高 | xxx |

### 7.2 假设条件
- [假设 1]
- [假设 2]

### 7.3 待确认问题
- [ ] [需要澄清的问题]

---

## 8. 测试策略

### 8.1 单元测试

- **目标覆盖率**：≥90%
- **测试重点模块**：[列出]
- **关键测试场景**：
  - [场景1]
  - [场景2]

### 8.2 集成测试

- **测试边界**：[描述]
- **关键集成点**：
  - [集成点1]
  - [集成点2]

### 8.3 测试数据准备

[描述测试数据的准备策略]

---

## 9. 部署与运维

### 9.1 配置项

| 配置 Key | 默认值 | 说明 | 变更影响 |
|----------|--------|------|----------|
| xxx | xxx | xxx | xxx |

### 9.2 灰度策略

[上线灰度方案]

### 9.3 回滚方案

[回滚步骤]

---

## 10. 附录

### A. 代码分析摘要
[codeagent/codex 分析的关键发现总结]

### B. 参考资料
- [参考 1]
- [参考 2]

### C. 变更记录
| 版本 | 日期 | 作者 | 变更说明 |
|------|------|------|----------|
| v1.0 | YYYY-MM-DD | xxx | 初始版本 |
